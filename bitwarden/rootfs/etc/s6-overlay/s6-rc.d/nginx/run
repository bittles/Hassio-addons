#!/command/with-contenv bashio
# ==============================================================================
# Home Assistant Community Add-on: Vaultwarden
# Runs the Nginx daemon
# ==============================================================================
bashio::net.wait_for 4110

declare ingress_interface
declare ingress_port

ingress_port=$(bashio::addon.ingress_port)
ingress_interface=$(bashio::addon.ip_address)

sed -i "s|%%port%%|${ingress_port}|g" /etc/nginx/servers/direct.conf
sed -i "s|%%interface%%|${ingress_interface}|g" /etc/nginx/servers/direct.conf


bashio::log.info "Starting NGinx..."

exec nginx
